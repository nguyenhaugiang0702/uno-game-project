"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/waiting-lobby/page",{

/***/ "(app-pages-browser)/./bots-server/BotsServer.ts":
/*!***********************************!*\
  !*** ./bots-server/BotsServer.ts ***!
  \***********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   canPlayCard: function() { return /* binding */ canPlayCard; },\n/* harmony export */   \"default\": function() { return /* binding */ BotsServer; }\n/* harmony export */ });\n/* harmony import */ var _utils_EventsObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/EventsObject */ \"(app-pages-browser)/./utils/EventsObject.ts\");\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/helpers */ \"(app-pages-browser)/./utils/helpers.ts\");\n/* harmony import */ var _data_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data.json */ \"(app-pages-browser)/./bots-server/data.json\");\n\n\n\nclass BotsServer extends _utils_EventsObject__WEBPACK_IMPORTED_MODULE_0__.EventsObject {\n    init() {\n        this.players = [];\n        this.curPlayer = 0;\n        this.direction = 1;\n        this.tableStk = [];\n        this.drawingStk = [];\n        this.sumDrawing = 0;\n        this.playersFinished = [];\n        this.lastPlayerDrew = false;\n        this.gameRunning = false;\n    }\n    joinPlayer(player) {\n        const playerId = this.players.length.toString();\n        this.players.push({\n            ...player,\n            id: playerId,\n            cards: []\n        });\n        return playerId;\n    }\n    addBots() {\n        const numToAdd = this.numberOfPlayers - this.players.length;\n        for(let i = 0; i < numToAdd; i++){\n            const bot = _data_json__WEBPACK_IMPORTED_MODULE_2__.players[i];\n            const playerId = this.players.length.toString();\n            this.players.push({\n                ...bot,\n                id: playerId,\n                cards: [],\n                isBot: true\n            });\n        }\n        this.fireEvent(\"players-changed\", this.players);\n        if (this.players.length === this.numberOfPlayers) setTimeout(()=>{\n            this.start();\n        }, 1000);\n    }\n    start() {\n        var _remainingCards_firstCardIndex, _remainingCards_firstCardIndex1;\n        const cards = [\n            ..._data_json__WEBPACK_IMPORTED_MODULE_2__.cards\n        ];\n        (0,_utils_helpers__WEBPACK_IMPORTED_MODULE_1__.shuffle)(cards);\n        (0,_utils_helpers__WEBPACK_IMPORTED_MODULE_1__.shuffle)(this.players);\n        const NUM_CARDS = 7;\n        this.players.forEach((player, idx)=>{\n            player.cards = cards.slice(idx * NUM_CARDS, (idx + 1) * NUM_CARDS);\n        });\n        // Place remaining cards in drawing stack\n        const remainingCards = cards.slice(this.players.length * NUM_CARDS);\n        // Take first card from drawing stack and place it on table\n        // Make sure it's not a wild card to start with\n        let firstCardIndex = 0;\n        while(((_remainingCards_firstCardIndex = remainingCards[firstCardIndex]) === null || _remainingCards_firstCardIndex === void 0 ? void 0 : _remainingCards_firstCardIndex.action) === \"wild\" || ((_remainingCards_firstCardIndex1 = remainingCards[firstCardIndex]) === null || _remainingCards_firstCardIndex1 === void 0 ? void 0 : _remainingCards_firstCardIndex1.action) === \"draw four\"){\n            firstCardIndex++;\n        }\n        this.tableStk = [\n            remainingCards[firstCardIndex]\n        ];\n        console.log(\"Move request:\", {\n            draw,\n            cardId,\n            card,\n            curPlayer: this.curPlayer\n        });\n        if (card && !canPlayCard(this.tableStk[0], card, this.lastPlayerDrew)) {\n            console.log(\"Move rejected: cannot play card\", {\n                tableCard: this.tableStk[0],\n                card\n            });\n            return false;\n        }\n        if (draw) {\n            let drawCnt = 1;\n            if (this.sumDrawing) {\n                drawCnt = this.sumDrawing;\n                this.sumDrawing = 0;\n            }\n            moveEventObj.draw = drawCnt;\n            if (drawCnt + 1 > this.drawingStk.length) {\n                this.drawingStk = (0,_utils_helpers__WEBPACK_IMPORTED_MODULE_1__.shuffle)(this.tableStk.slice(5, this.tableStk.length));\n                this.tableStk = this.tableStk.slice(0, 5);\n            }\n            moveEventObj.cardsToDraw = this.drawingStk.slice(0, drawCnt);\n            this.players[this.curPlayer].cards = this.drawingStk.slice(0, drawCnt).concat(this.players[this.curPlayer].cards);\n            this.drawingStk = this.drawingStk.slice(drawCnt, this.drawingStk.length);\n            this.lastPlayerDrew = true;\n        }\n        let nxtPlayer = this.getNextPlayer(card);\n        moveEventObj.curPlayer = this.curPlayer;\n        moveEventObj.nxtPlayer = nxtPlayer;\n        if (card) {\n            if (card.action === \"draw two\") this.sumDrawing += 2;\n            if (card.action === \"draw four\") this.sumDrawing += 4;\n            this.tableStk.unshift(card);\n            moveEventObj.card = card;\n            // Only try to remove card from player if they have it (system might play first card)\n            const hasCard = this.players[this.curPlayer].cards.some((c)=>{\n                var _card;\n                return c.id === ((_card = card) === null || _card === void 0 ? void 0 : _card.id);\n            });\n            if (hasCard) {\n                this.players[this.curPlayer].cards = this.players[this.curPlayer].cards.filter((c)=>{\n                    var _card;\n                    return c.id !== ((_card = card) === null || _card === void 0 ? void 0 : _card.id);\n                });\n            }\n            this.lastPlayerDrew = false;\n            // Check if game finished\n            if (this.players[this.curPlayer].cards.length === 0) this.playersFinished.push(this.curPlayer);\n            if (this.playersFinished.length === this.players.length - 1) {\n                this.playersFinished.push(nxtPlayer);\n                this.finishGame();\n                this.fireEvent(\"move\", moveEventObj);\n                return;\n            }\n        }\n        this.curPlayer = nxtPlayer;\n        this.fireEvent(\"move\", moveEventObj);\n        if (this.players[this.curPlayer].isBot) this.moveBot();\n    }\n    getNextPlayer(card1) {\n        var _this = this;\n        let nxtPlayer = this.curPlayer;\n        if ((card1 === null || card1 === void 0 ? void 0 : card1.action) === \"reverse\") this.direction *= -1;\n        const moveForward = function() {\n            let steps = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 1;\n            while(steps--){\n                nxtPlayer = (0,_utils_helpers__WEBPACK_IMPORTED_MODULE_1__.wrapMod)(nxtPlayer + 1 * _this.direction, _this.players.length);\n                while(_this.players[nxtPlayer].cards.length === 0)nxtPlayer = (0,_utils_helpers__WEBPACK_IMPORTED_MODULE_1__.wrapMod)(nxtPlayer + 1 * _this.direction, _this.players.length);\n            }\n        };\n        //Move to next player ( if not wild card )\n        if ((card1 === null || card1 === void 0 ? void 0 : card1.action) === \"skip\") {\n            moveForward(2);\n        } else if ((card1 === null || card1 === void 0 ? void 0 : card1.action) !== \"wild\") moveForward();\n        return nxtPlayer;\n    }\n    moveBot() {\n        setTimeout(()=>{\n            for(let i = 0; i < this.players[this.curPlayer].cards.length; i++){\n                const card1 = this.players[this.curPlayer].cards[i];\n                if (canPlayCard(this.tableStk[0], card1, this.lastPlayerDrew)) return this.move(false, card1.id);\n            }\n            return this.move(true, null);\n        }, 1500);\n    }\n    finishGame() {\n        const playersFinishingOrder = this.playersFinished.map((idx)=>this.players[idx]);\n        this.init();\n        this.fireEvent(\"finish-game\", playersFinishingOrder);\n    }\n    constructor(numberOfPlayers = 4){\n        super();\n        this.players = [];\n        this.curPlayer = 0;\n        this.direction = 1;\n        this.tableStk = [];\n        this.drawingStk = [];\n        this.sumDrawing = 0;\n        this.lastPlayerDrew = false;\n        this.playersFinished = [];\n        this.gameRunning = false;\n        this.numberOfPlayers = 4;\n        this.botTimeout = null;\n        this.numberOfPlayers = numberOfPlayers;\n    }\n}\n\nfunction canPlayCard(oldCard, newCard, lastPlayerDrew) {\n    const isOldDawingCard = (oldCard === null || oldCard === void 0 ? void 0 : oldCard.action) && oldCard.action.indexOf(\"draw\") !== -1;\n    const haveToDraw = isOldDawingCard && !lastPlayerDrew;\n    const isNewDawingCard = (newCard === null || newCard === void 0 ? void 0 : newCard.action) && newCard.action.indexOf(\"draw\") !== -1;\n    //No Card Played Yet\n    if (!oldCard) return true;\n    if (!haveToDraw && newCard.action === \"wild\") return true;\n    if (newCard.action === \"draw four\") return true;\n    if (oldCard.color === \"black\" && !haveToDraw) return true;\n    if (haveToDraw && isNewDawingCard) return true;\n    if (!haveToDraw && oldCard.color === newCard.color) return true;\n    if (oldCard.digit !== undefined && oldCard.digit === newCard.digit) return true;\n    return false;\n}\nconst getCardById = (id)=>_data_json__WEBPACK_IMPORTED_MODULE_2__.cards.find((c)=>c.id === id);\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2JvdHMtc2VydmVyL0JvdHNTZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBbUQ7QUFDRDtBQUVwQjtBQWdCZixNQUFNSSxtQkFBbUJKLDZEQUFZQTtJQW1CbERLLE9BQU87UUFDTCxJQUFJLENBQUNDLE9BQU8sR0FBRyxFQUFFO1FBQ2pCLElBQUksQ0FBQ0MsU0FBUyxHQUFHO1FBQ2pCLElBQUksQ0FBQ0MsU0FBUyxHQUFHO1FBQ2pCLElBQUksQ0FBQ0MsUUFBUSxHQUFHLEVBQUU7UUFDbEIsSUFBSSxDQUFDQyxVQUFVLEdBQUcsRUFBRTtRQUNwQixJQUFJLENBQUNDLFVBQVUsR0FBRztRQUNsQixJQUFJLENBQUNDLGVBQWUsR0FBRyxFQUFFO1FBQ3pCLElBQUksQ0FBQ0MsY0FBYyxHQUFHO1FBQ3RCLElBQUksQ0FBQ0MsV0FBVyxHQUFHO0lBQ3JCO0lBRUFDLFdBQVdDLE1BQWMsRUFBRTtRQUN6QixNQUFNQyxXQUFXLElBQUksQ0FBQ1gsT0FBTyxDQUFDWSxNQUFNLENBQUNDLFFBQVE7UUFFN0MsSUFBSSxDQUFDYixPQUFPLENBQUNjLElBQUksQ0FBQztZQUNoQixHQUFHSixNQUFNO1lBQ1RLLElBQUlKO1lBQ0pLLE9BQU8sRUFBRTtRQUNYO1FBRUEsT0FBT0w7SUFDVDtJQUVBTSxVQUFVO1FBQ1IsTUFBTUMsV0FBVyxJQUFJLENBQUNDLGVBQWUsR0FBRyxJQUFJLENBQUNuQixPQUFPLENBQUNZLE1BQU07UUFDM0QsSUFBSyxJQUFJUSxJQUFJLEdBQUdBLElBQUlGLFVBQVVFLElBQUs7WUFDakMsTUFBTUMsTUFBTSwrQ0FBcUIsQ0FBQ0QsRUFBRTtZQUNwQyxNQUFNVCxXQUFXLElBQUksQ0FBQ1gsT0FBTyxDQUFDWSxNQUFNLENBQUNDLFFBQVE7WUFDN0MsSUFBSSxDQUFDYixPQUFPLENBQUNjLElBQUksQ0FBQztnQkFDaEIsR0FBR08sR0FBRztnQkFDTk4sSUFBSUo7Z0JBQ0pLLE9BQU8sRUFBRTtnQkFDVE0s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QUFBQSxRQUFTNUIsTUFBTSxLQUFJNEIsUUFBUTVCLE1BQU0sQ0FBQytCLE9BQU8sQ0FBQyxZQUFZLENBQUM7SUFDekQsTUFBTUMsYUFBYUYsbUJBQW1CLENBQUN2RDtJQUN2QyxNQUFNMEQsa0JBQ0pKLENBQUFBLG9CQUFBQSw4QkFBQUEsUUFBUzdCLE1BQU0sS0FBSTZCLFFBQVE3QixNQUFNLENBQUMrQixPQUFPLENBQUMsWUFBWSxDQUFDO0lBRXpELG9CQUFvQjtJQUNwQixJQUFJLENBQUNILFNBQVMsT0FBTztJQUVyQixJQUFJLENBQUNJLGNBQWNILFFBQVE3QixNQUFNLEtBQUssUUFBUSxPQUFPO0lBRXJELElBQUk2QixRQUFRN0IsTUFBTSxLQUFLLGFBQWEsT0FBTztJQUUzQyxJQUFJNEIsUUFBUU0sS0FBSyxLQUFLLFdBQVcsQ0FBQ0YsWUFBWSxPQUFPO0lBRXJELElBQUlBLGNBQWNDLGlCQUFpQixPQUFPO0lBRTFDLElBQUksQ0FBQ0QsY0FBY0osUUFBUU0sS0FBSyxLQUFLTCxRQUFRSyxLQUFLLEVBQUUsT0FBTztJQUUzRCxJQUFJTixRQUFRTyxLQUFLLEtBQUtDLGFBQWFSLFFBQVFPLEtBQUssS0FBS04sUUFBUU0sS0FBSyxFQUNoRSxPQUFPO0lBRVQsT0FBTztBQUNUO0FBRUEsTUFBTUUsY0FBYyxDQUFDdEQsS0FDbkIsNkNBQW1CLENBQUN1RCxJQUFJLENBQUMsQ0FBQ3JCLElBQVlBLEVBQUVsQyxFQUFFLEtBQUtBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2JvdHMtc2VydmVyL0JvdHNTZXJ2ZXIudHM/OTc5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudHNPYmplY3QgfSBmcm9tICdAL3V0aWxzL0V2ZW50c09iamVjdCdcclxuaW1wb3J0IHsgc2h1ZmZsZSwgd3JhcE1vZCB9IGZyb20gJ0AvdXRpbHMvaGVscGVycydcclxuaW1wb3J0IHsgQ2FyZCwgUGxheWVyIH0gZnJvbSAnQC91dGlscy9pbnRlcmZhY2VzJ1xyXG5pbXBvcnQgZGF0YSBmcm9tICcuL2RhdGEuanNvbidcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1vdmVFdmVudCB7XHJcbiAgY3VyUGxheWVyOiBudW1iZXJcclxuICBueHRQbGF5ZXI6IG51bWJlclxyXG4gIGNhcmQ/OiBDYXJkXHJcbiAgZHJhdz86IG51bWJlclxyXG4gIGNhcmRzVG9EcmF3PzogQ2FyZFtdXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVN0YXJ0RXZlbnQge1xyXG4gIGNhcmRzOiBDYXJkW11cclxuICBwbGF5ZXJzOiBQbGF5ZXJbXVxyXG4gIHBsYXllcklkOiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm90c1NlcnZlciBleHRlbmRzIEV2ZW50c09iamVjdCB7XHJcbiAgcGxheWVyczogUGxheWVyW10gPSBbXVxyXG4gIGN1clBsYXllciA9IDBcclxuICBkaXJlY3Rpb24gPSAxXHJcbiAgdGFibGVTdGs6IENhcmRbXSA9IFtdXHJcbiAgZHJhd2luZ1N0azogQ2FyZFtdID0gW11cclxuICBzdW1EcmF3aW5nID0gMFxyXG4gIGxhc3RQbGF5ZXJEcmV3ID0gZmFsc2VcclxuICBwbGF5ZXJzRmluaXNoZWQ6IG51bWJlcltdID0gW11cclxuICBnYW1lUnVubmluZyA9IGZhbHNlXHJcbiAgbnVtYmVyT2ZQbGF5ZXJzID0gNFxyXG5cclxuICBib3RUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsXHJcblxyXG4gIGNvbnN0cnVjdG9yKG51bWJlck9mUGxheWVycyA9IDQpIHtcclxuICAgIHN1cGVyKClcclxuICAgIHRoaXMubnVtYmVyT2ZQbGF5ZXJzID0gbnVtYmVyT2ZQbGF5ZXJzXHJcbiAgfVxyXG5cclxuICBpbml0KCkge1xyXG4gICAgdGhpcy5wbGF5ZXJzID0gW11cclxuICAgIHRoaXMuY3VyUGxheWVyID0gMFxyXG4gICAgdGhpcy5kaXJlY3Rpb24gPSAxXHJcbiAgICB0aGlzLnRhYmxlU3RrID0gW11cclxuICAgIHRoaXMuZHJhd2luZ1N0ayA9IFtdXHJcbiAgICB0aGlzLnN1bURyYXdpbmcgPSAwXHJcbiAgICB0aGlzLnBsYXllcnNGaW5pc2hlZCA9IFtdXHJcbiAgICB0aGlzLmxhc3RQbGF5ZXJEcmV3ID0gZmFsc2VcclxuICAgIHRoaXMuZ2FtZVJ1bm5pbmcgPSBmYWxzZVxyXG4gIH1cclxuXHJcbiAgam9pblBsYXllcihwbGF5ZXI6IFBsYXllcikge1xyXG4gICAgY29uc3QgcGxheWVySWQgPSB0aGlzLnBsYXllcnMubGVuZ3RoLnRvU3RyaW5nKClcclxuXHJcbiAgICB0aGlzLnBsYXllcnMucHVzaCh7XHJcbiAgICAgIC4uLnBsYXllcixcclxuICAgICAgaWQ6IHBsYXllcklkLFxyXG4gICAgICBjYXJkczogW10sXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBwbGF5ZXJJZFxyXG4gIH1cclxuXHJcbiAgYWRkQm90cygpIHtcclxuICAgIGNvbnN0IG51bVRvQWRkID0gdGhpcy5udW1iZXJPZlBsYXllcnMgLSB0aGlzLnBsYXllcnMubGVuZ3RoXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVRvQWRkOyBpKyspIHtcclxuICAgICAgY29uc3QgYm90ID0gKGRhdGEgYXMgYW55KS5wbGF5ZXJzW2ldXHJcbiAgICAgIGNvbnN0IHBsYXllcklkID0gdGhpcy5wbGF5ZXJzLmxlbmd0aC50b1N0cmluZygpXHJcbiAgICAgIHRoaXMucGxheWVycy5wdXNoKHtcclxuICAgICAgICAuLi5ib3QsXHJcbiAgICAgICAgaWQ6IHBsYXllcklkLFxyXG4gICAgICAgIGNhcmRzOiBbXSxcclxuICAgICAgICBpc0JvdDogdHJ1ZSxcclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIHRoaXMuZmlyZUV2ZW50KCdwbGF5ZXJzLWNoYW5nZWQnLCB0aGlzLnBsYXllcnMpXHJcbiAgICBpZiAodGhpcy5wbGF5ZXJzLmxlbmd0aCA9PT0gdGhpcy5udW1iZXJPZlBsYXllcnMpXHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc3RhcnQoKVxyXG4gICAgICB9LCAxMDAwKVxyXG4gIH1cclxuXHJcbiAgc3RhcnQoKSB7XHJcbiAgICBjb25zdCBjYXJkcyA9IFsuLi4oZGF0YSBhcyBhbnkpLmNhcmRzXSBhcyBDYXJkW11cclxuICAgIHNodWZmbGUoY2FyZHMpXHJcbiAgICBzaHVmZmxlKHRoaXMucGxheWVycylcclxuICAgIGNvbnN0IE5VTV9DQVJEUyA9IDdcclxuICAgIHRoaXMucGxheWVycy5mb3JFYWNoKChwbGF5ZXIsIGlkeCkgPT4ge1xyXG4gICAgICBwbGF5ZXIuY2FyZHMgPSBjYXJkcy5zbGljZShpZHggKiBOVU1fQ0FSRFMsIChpZHggKyAxKSAqIE5VTV9DQVJEUylcclxuICAgIH0pXHJcblxyXG4gICAgLy8gUGxhY2UgcmVtYWluaW5nIGNhcmRzIGluIGRyYXdpbmcgc3RhY2tcclxuICAgIGNvbnN0IHJlbWFpbmluZ0NhcmRzID0gY2FyZHMuc2xpY2UodGhpcy5wbGF5ZXJzLmxlbmd0aCAqIE5VTV9DQVJEUylcclxuXHJcbiAgICAvLyBUYWtlIGZpcnN0IGNhcmQgZnJvbSBkcmF3aW5nIHN0YWNrIGFuZCBwbGFjZSBpdCBvbiB0YWJsZVxyXG4gICAgLy8gTWFrZSBzdXJlIGl0J3Mgbm90IGEgd2lsZCBjYXJkIHRvIHN0YXJ0IHdpdGhcclxuICAgIGxldCBmaXJzdENhcmRJbmRleCA9IDBcclxuICAgIHdoaWxlIChyZW1haW5pbmdDYXJkc1tmaXJzdENhcmRJbmRleF0/LmFjdGlvbiA9PT0gJ3dpbGQnIHx8XHJcbiAgICAgIHJlbWFpbmluZ0NhcmRzW2ZpcnN0Q2FyZEluZGV4XT8uYWN0aW9uID09PSAnZHJhdyBmb3VyJykge1xyXG4gICAgICBmaXJzdENhcmRJbmRleCsrXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy50YWJsZVN0ayA9IFtyZW1haW5pbmdDYXJkc1tmaXJzdENhcmRJbmRleF1dXHJcblxyXG4gICAgY29uc29sZS5sb2coJ01vdmUgcmVxdWVzdDonLCB7IGRyYXcsIGNhcmRJZCwgY2FyZCwgY3VyUGxheWVyOiB0aGlzLmN1clBsYXllciB9KVxyXG5cclxuICAgIGlmIChjYXJkICYmICFjYW5QbGF5Q2FyZCh0aGlzLnRhYmxlU3RrWzBdLCBjYXJkLCB0aGlzLmxhc3RQbGF5ZXJEcmV3KSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnTW92ZSByZWplY3RlZDogY2Fubm90IHBsYXkgY2FyZCcsIHsgdGFibGVDYXJkOiB0aGlzLnRhYmxlU3RrWzBdLCBjYXJkIH0pXHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChkcmF3KSB7XHJcbiAgICAgIGxldCBkcmF3Q250ID0gMVxyXG4gICAgICBpZiAodGhpcy5zdW1EcmF3aW5nKSB7XHJcbiAgICAgICAgZHJhd0NudCA9IHRoaXMuc3VtRHJhd2luZ1xyXG4gICAgICAgIHRoaXMuc3VtRHJhd2luZyA9IDBcclxuICAgICAgfVxyXG5cclxuICAgICAgbW92ZUV2ZW50T2JqLmRyYXcgPSBkcmF3Q250XHJcbiAgICAgIGlmIChkcmF3Q250ICsgMSA+IHRoaXMuZHJhd2luZ1N0ay5sZW5ndGgpIHtcclxuICAgICAgICB0aGlzLmRyYXdpbmdTdGsgPSBzaHVmZmxlKFxyXG4gICAgICAgICAgdGhpcy50YWJsZVN0ay5zbGljZSg1LCB0aGlzLnRhYmxlU3RrLmxlbmd0aClcclxuICAgICAgICApIGFzIENhcmRbXVxyXG4gICAgICAgIHRoaXMudGFibGVTdGsgPSB0aGlzLnRhYmxlU3RrLnNsaWNlKDAsIDUpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG1vdmVFdmVudE9iai5jYXJkc1RvRHJhdyA9IHRoaXMuZHJhd2luZ1N0ay5zbGljZSgwLCBkcmF3Q250KVxyXG4gICAgICB0aGlzLnBsYXllcnNbdGhpcy5jdXJQbGF5ZXJdLmNhcmRzID0gdGhpcy5kcmF3aW5nU3RrXHJcbiAgICAgICAgLnNsaWNlKDAsIGRyYXdDbnQpXHJcbiAgICAgICAgLmNvbmNhdCh0aGlzLnBsYXllcnNbdGhpcy5jdXJQbGF5ZXJdLmNhcmRzKVxyXG5cclxuICAgICAgdGhpcy5kcmF3aW5nU3RrID0gdGhpcy5kcmF3aW5nU3RrLnNsaWNlKGRyYXdDbnQsIHRoaXMuZHJhd2luZ1N0ay5sZW5ndGgpXHJcbiAgICAgIHRoaXMubGFzdFBsYXllckRyZXcgPSB0cnVlXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG54dFBsYXllciA9IHRoaXMuZ2V0TmV4dFBsYXllcihjYXJkKVxyXG5cclxuICAgIG1vdmVFdmVudE9iai5jdXJQbGF5ZXIgPSB0aGlzLmN1clBsYXllclxyXG4gICAgbW92ZUV2ZW50T2JqLm54dFBsYXllciA9IG54dFBsYXllclxyXG5cclxuICAgIGlmIChjYXJkKSB7XHJcbiAgICAgIGlmIChjYXJkLmFjdGlvbiA9PT0gJ2RyYXcgdHdvJykgdGhpcy5zdW1EcmF3aW5nICs9IDJcclxuICAgICAgaWYgKGNhcmQuYWN0aW9uID09PSAnZHJhdyBmb3VyJykgdGhpcy5zdW1EcmF3aW5nICs9IDRcclxuXHJcbiAgICAgIHRoaXMudGFibGVTdGsudW5zaGlmdChjYXJkKVxyXG4gICAgICBtb3ZlRXZlbnRPYmouY2FyZCA9IGNhcmRcclxuXHJcbiAgICAgIC8vIE9ubHkgdHJ5IHRvIHJlbW92ZSBjYXJkIGZyb20gcGxheWVyIGlmIHRoZXkgaGF2ZSBpdCAoc3lzdGVtIG1pZ2h0IHBsYXkgZmlyc3QgY2FyZClcclxuICAgICAgY29uc3QgaGFzQ2FyZCA9IHRoaXMucGxheWVyc1t0aGlzLmN1clBsYXllcl0uY2FyZHMuc29tZShjID0+IGMuaWQgPT09IGNhcmQ/LmlkKVxyXG4gICAgICBpZiAoaGFzQ2FyZCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyc1t0aGlzLmN1clBsYXllcl0uY2FyZHMgPSB0aGlzLnBsYXllcnNbXHJcbiAgICAgICAgICB0aGlzLmN1clBsYXllclxyXG4gICAgICAgIF0uY2FyZHMuZmlsdGVyKChjKSA9PiBjLmlkICE9PSBjYXJkPy5pZClcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmxhc3RQbGF5ZXJEcmV3ID0gZmFsc2VcclxuXHJcbiAgICAgIC8vIENoZWNrIGlmIGdhbWUgZmluaXNoZWRcclxuICAgICAgaWYgKHRoaXMucGxheWVyc1t0aGlzLmN1clBsYXllcl0uY2FyZHMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgIHRoaXMucGxheWVyc0ZpbmlzaGVkLnB1c2godGhpcy5jdXJQbGF5ZXIpXHJcbiAgICAgIGlmICh0aGlzLnBsYXllcnNGaW5pc2hlZC5sZW5ndGggPT09IHRoaXMucGxheWVycy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzRmluaXNoZWQucHVzaChueHRQbGF5ZXIpXHJcbiAgICAgICAgdGhpcy5maW5pc2hHYW1lKClcclxuICAgICAgICB0aGlzLmZpcmVFdmVudCgnbW92ZScsIG1vdmVFdmVudE9iaiBhcyBJTW92ZUV2ZW50KVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jdXJQbGF5ZXIgPSBueHRQbGF5ZXJcclxuXHJcbiAgICB0aGlzLmZpcmVFdmVudCgnbW92ZScsIG1vdmVFdmVudE9iaiBhcyBJTW92ZUV2ZW50KVxyXG5cclxuICAgIGlmICh0aGlzLnBsYXllcnNbdGhpcy5jdXJQbGF5ZXJdLmlzQm90KSB0aGlzLm1vdmVCb3QoKVxyXG4gIH1cclxuXHJcbiAgZ2V0TmV4dFBsYXllcihjYXJkPzogQ2FyZCkge1xyXG4gICAgbGV0IG54dFBsYXllciA9IHRoaXMuY3VyUGxheWVyXHJcblxyXG4gICAgaWYgKGNhcmQ/LmFjdGlvbiA9PT0gJ3JldmVyc2UnKSB0aGlzLmRpcmVjdGlvbiAqPSAtMVxyXG5cclxuICAgIGNvbnN0IG1vdmVGb3J3YXJkID0gKHN0ZXBzOiBudW1iZXIgPSAxKSA9PiB7XHJcbiAgICAgIHdoaWxlIChzdGVwcy0tKSB7XHJcbiAgICAgICAgbnh0UGxheWVyID0gd3JhcE1vZChcclxuICAgICAgICAgIG54dFBsYXllciArIDEgKiB0aGlzLmRpcmVjdGlvbixcclxuICAgICAgICAgIHRoaXMucGxheWVycy5sZW5ndGhcclxuICAgICAgICApXHJcbiAgICAgICAgd2hpbGUgKHRoaXMucGxheWVyc1tueHRQbGF5ZXJdLmNhcmRzLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgIG54dFBsYXllciA9IHdyYXBNb2QoXHJcbiAgICAgICAgICAgIG54dFBsYXllciArIDEgKiB0aGlzLmRpcmVjdGlvbixcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJzLmxlbmd0aFxyXG4gICAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9Nb3ZlIHRvIG5leHQgcGxheWVyICggaWYgbm90IHdpbGQgY2FyZCApXHJcbiAgICBpZiAoY2FyZD8uYWN0aW9uID09PSAnc2tpcCcpIHtcclxuICAgICAgbW92ZUZvcndhcmQoMilcclxuICAgIH0gZWxzZSBpZiAoY2FyZD8uYWN0aW9uICE9PSAnd2lsZCcpIG1vdmVGb3J3YXJkKClcclxuXHJcbiAgICByZXR1cm4gbnh0UGxheWVyXHJcbiAgfVxyXG5cclxuICBtb3ZlQm90KCkge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbGF5ZXJzW3RoaXMuY3VyUGxheWVyXS5jYXJkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLnBsYXllcnNbdGhpcy5jdXJQbGF5ZXJdLmNhcmRzW2ldXHJcblxyXG4gICAgICAgIGlmIChjYW5QbGF5Q2FyZCh0aGlzLnRhYmxlU3RrWzBdLCBjYXJkLCB0aGlzLmxhc3RQbGF5ZXJEcmV3KSlcclxuICAgICAgICAgIHJldHVybiB0aGlzLm1vdmUoZmFsc2UsIGNhcmQuaWQgYXMgc3RyaW5nKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5tb3ZlKHRydWUsIG51bGwpXHJcbiAgICB9LCAxNTAwKVxyXG4gIH1cclxuXHJcbiAgZmluaXNoR2FtZSgpIHtcclxuICAgIGNvbnN0IHBsYXllcnNGaW5pc2hpbmdPcmRlciA9IHRoaXMucGxheWVyc0ZpbmlzaGVkLm1hcChcclxuICAgICAgKGlkeCkgPT4gdGhpcy5wbGF5ZXJzW2lkeF1cclxuICAgIClcclxuXHJcbiAgICB0aGlzLmluaXQoKVxyXG4gICAgdGhpcy5maXJlRXZlbnQoJ2ZpbmlzaC1nYW1lJywgcGxheWVyc0ZpbmlzaGluZ09yZGVyKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhblBsYXlDYXJkKFxyXG4gIG9sZENhcmQ6IENhcmQsXHJcbiAgbmV3Q2FyZDogQ2FyZCxcclxuICBsYXN0UGxheWVyRHJldzogYm9vbGVhblxyXG4pIHtcclxuICBjb25zdCBpc09sZERhd2luZ0NhcmQgPVxyXG4gICAgb2xkQ2FyZD8uYWN0aW9uICYmIG9sZENhcmQuYWN0aW9uLmluZGV4T2YoJ2RyYXcnKSAhPT0gLTFcclxuICBjb25zdCBoYXZlVG9EcmF3ID0gaXNPbGREYXdpbmdDYXJkICYmICFsYXN0UGxheWVyRHJld1xyXG4gIGNvbnN0IGlzTmV3RGF3aW5nQ2FyZCA9XHJcbiAgICBuZXdDYXJkPy5hY3Rpb24gJiYgbmV3Q2FyZC5hY3Rpb24uaW5kZXhPZignZHJhdycpICE9PSAtMVxyXG5cclxuICAvL05vIENhcmQgUGxheWVkIFlldFxyXG4gIGlmICghb2xkQ2FyZCkgcmV0dXJuIHRydWVcclxuXHJcbiAgaWYgKCFoYXZlVG9EcmF3ICYmIG5ld0NhcmQuYWN0aW9uID09PSAnd2lsZCcpIHJldHVybiB0cnVlXHJcblxyXG4gIGlmIChuZXdDYXJkLmFjdGlvbiA9PT0gJ2RyYXcgZm91cicpIHJldHVybiB0cnVlXHJcblxyXG4gIGlmIChvbGRDYXJkLmNvbG9yID09PSAnYmxhY2snICYmICFoYXZlVG9EcmF3KSByZXR1cm4gdHJ1ZVxyXG5cclxuICBpZiAoaGF2ZVRvRHJhdyAmJiBpc05ld0Rhd2luZ0NhcmQpIHJldHVybiB0cnVlXHJcblxyXG4gIGlmICghaGF2ZVRvRHJhdyAmJiBvbGRDYXJkLmNvbG9yID09PSBuZXdDYXJkLmNvbG9yKSByZXR1cm4gdHJ1ZVxyXG5cclxuICBpZiAob2xkQ2FyZC5kaWdpdCAhPT0gdW5kZWZpbmVkICYmIG9sZENhcmQuZGlnaXQgPT09IG5ld0NhcmQuZGlnaXQpXHJcbiAgICByZXR1cm4gdHJ1ZVxyXG5cclxuICByZXR1cm4gZmFsc2VcclxufVxyXG5cclxuY29uc3QgZ2V0Q2FyZEJ5SWQgPSAoaWQ6IHN0cmluZykgPT5cclxuICAoZGF0YSBhcyBhbnkpLmNhcmRzLmZpbmQoKGM6IENhcmQpID0+IGMuaWQgPT09IGlkKVxyXG5cclxuIl0sIm5hbWVzIjpbIkV2ZW50c09iamVjdCIsInNodWZmbGUiLCJ3cmFwTW9kIiwiZGF0YSIsIkJvdHNTZXJ2ZXIiLCJpbml0IiwicGxheWVycyIsImN1clBsYXllciIsImRpcmVjdGlvbiIsInRhYmxlU3RrIiwiZHJhd2luZ1N0ayIsInN1bURyYXdpbmciLCJwbGF5ZXJzRmluaXNoZWQiLCJsYXN0UGxheWVyRHJldyIsImdhbWVSdW5uaW5nIiwiam9pblBsYXllciIsInBsYXllciIsInBsYXllcklkIiwibGVuZ3RoIiwidG9TdHJpbmciLCJwdXNoIiwiaWQiLCJjYXJkcyIsImFkZEJvdHMiLCJudW1Ub0FkZCIsIm51bWJlck9mUGxheWVycyIsImkiLCJib3QiLCJpc0JvdCIsImZpcmVFdmVudCIsInNldFRpbWVvdXQiLCJzdGFydCIsInJlbWFpbmluZ0NhcmRzIiwiTlVNX0NBUkRTIiwiZm9yRWFjaCIsImlkeCIsInNsaWNlIiwiZmlyc3RDYXJkSW5kZXgiLCJhY3Rpb24iLCJjb25zb2xlIiwibG9nIiwiZHJhdyIsImNhcmRJZCIsImNhcmQiLCJjYW5QbGF5Q2FyZCIsInRhYmxlQ2FyZCIsImRyYXdDbnQiLCJtb3ZlRXZlbnRPYmoiLCJjYXJkc1RvRHJhdyIsImNvbmNhdCIsIm54dFBsYXllciIsImdldE5leHRQbGF5ZXIiLCJ1bnNoaWZ0IiwiaGFzQ2FyZCIsInNvbWUiLCJjIiwiZmlsdGVyIiwiZmluaXNoR2FtZSIsIm1vdmVCb3QiLCJtb3ZlRm9yd2FyZCIsInN0ZXBzIiwibW92ZSIsInBsYXllcnNGaW5pc2hpbmdPcmRlciIsIm1hcCIsImNvbnN0cnVjdG9yIiwiYm90VGltZW91dCIsIm9sZENhcmQiLCJuZXdDYXJkIiwiaXNPbGREYXdpbmdDYXJkIiwiaW5kZXhPZiIsImhhdmVUb0RyYXciLCJpc05ld0Rhd2luZ0NhcmQiLCJjb2xvciIsImRpZ2l0IiwidW5kZWZpbmVkIiwiZ2V0Q2FyZEJ5SWQiLCJmaW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./bots-server/BotsServer.ts\n"));

/***/ })

});